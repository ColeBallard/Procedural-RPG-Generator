<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Procedural Game Narrative Generation</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>

    <!-- Handlebars -->
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>

    <!-- Custom JS -->
    <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
</head>

<body>
    <div class="container-fluid">
        <!-- Landing Page (Authentication) -->
        <div id="landing-page" class="landing-page-container">
            <div class="landing-content">
                <div class="landing-header">
                    <h1 class="landing-title">üéÆ Procedural RPG Generator</h1>
                    <p class="landing-subtitle">Create your own epic adventure with AI-powered narrative generation</p>
                </div>

                <!-- Sign In Form -->
                <div id="signin-form" class="auth-form">
                    <h2 class="auth-title">Sign In</h2>
                    <div class="form-group">
                        <label for="signin-username">Username</label>
                        <input type="text" class="form-control" id="signin-username" placeholder="Enter your username">
                    </div>
                    <div class="form-group">
                        <label for="signin-password">Password</label>
                        <input type="password" class="form-control" id="signin-password" placeholder="Enter your password">
                    </div>
                    <div id="signin-error" class="auth-error"></div>
                    <button class="auth-button" id="signin-btn">Sign In</button>
                    <p class="auth-switch">Don't have an account? <a href="#" id="show-signup">Sign up</a></p>
                </div>

                <!-- Sign Up Form -->
                <div id="signup-form" class="auth-form" style="display: none;">
                    <h2 class="auth-title">Create Account</h2>
                    <div class="form-group">
                        <label for="signup-username">Username</label>
                        <input type="text" class="form-control" id="signup-username" placeholder="Choose a username">
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email</label>
                        <input type="email" class="form-control" id="signup-email" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <input type="password" class="form-control" id="signup-password" placeholder="Choose a password">
                    </div>
                    <div id="signup-error" class="auth-error"></div>
                    <button class="auth-button" id="signup-btn">Create Account</button>
                    <p class="auth-switch">Already have an account? <a href="#" id="show-signin">Sign in</a></p>
                </div>
            </div>
        </div>

        <!-- Header Section -->
        <div class="row align-items-center" id="app-header" style="display: none;">
            <div class="col">
                <h1>üéÆ Procedural Game Narrative Generation</h1>
            </div>
            <div class="col-auto">
                <span id="user-welcome" class="user-welcome"></span>
                <button class="btn btn-secondary" id="logout-btn" style="margin-left: 1rem;">
                    üö™ Logout
                </button>
                <button class="btn btn-secondary" id="back-to-menu-btn" style="display: none;">
                    ‚¨ÖÔ∏è Main Menu
                </button>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="main-menu" class="main-menu-container">
            <div class="menu-content">
                <h2 class="menu-title">Main Menu</h2>
                <div class="menu-buttons">
                    <button class="menu-button" id="menu-new-game-btn">
                        <span class="menu-icon">‚ú®</span>
                        <span class="menu-text">New Game</span>
                    </button>
                    <button class="menu-button" id="menu-load-game-btn">
                        <span class="menu-icon">üíæ</span>
                        <span class="menu-text">Load Game</span>
                    </button>
                    <button class="menu-button" id="menu-api-keys-btn">
                        <span class="menu-icon">üîë</span>
                        <span class="menu-text">API Keys</span>
                    </button>
                    <button class="menu-button" id="menu-story-settings-btn">
                        <span class="menu-icon">üìñ</span>
                        <span class="menu-text">Story Settings</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="container-fluid" id="game-view">
            <div class="row">
                <div class="col-md-3 border border-white rounded scrollable-section">
                    <h3 class="title">Info</h3>
                    <div class="accordion accordion-flush" id="infoAccordion">
                        <!-- Locations Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingLocations">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseLocations" aria-expanded="false"
                                    aria-controls="flush-collapseLocations">
                                    Locations
                                </button>
                            </h2>
                            <div id="flush-collapseLocations" class="accordion-collapse collapse"
                                aria-labelledby="headingLocations">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added location accordions -->
                                    <div class="accordion accordion-flush" id="locationsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Events Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingEvents">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseEvents" aria-expanded="false"
                                    aria-controls="flush-collapseEvents">
                                    Events
                                </button>
                            </h2>
                            <div id="flush-collapseEvents" class="accordion-collapse collapse"
                                aria-labelledby="headingEvents">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added event accordions -->
                                    <div class="accordion accordion-flush" id="eventsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Interacting Characters Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingCharacters">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseCharacters" aria-expanded="false"
                                    aria-controls="flush-collapseCharacters">
                                    Interacting Characters
                                </button>
                            </h2>
                            <div id="flush-collapseCharacters" class="accordion-collapse collapse"
                                aria-labelledby="headingCharacters">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added character accordions -->
                                    <div class="accordion accordion-flush" id="charactersAccordion"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Middle Column: Main Game Area -->
                <div class="col-md-5 scrollable-section">
                    <div id="game-output">
                        <!-- Narrative content goes here -->
                        <ul class="nav flex-column" id="narrativeList"></ul>
                    </div>
                    <div id="user-options">
                        <!-- Pre-determined options -->
                        <ul class="nav flex-column" id="optionsList"></ul>
                        <textarea id="game-input" name="game-input" class="form-control"
                            placeholder="Or go your own way..."></textarea>
                        <button type="button" class="btn btn-primary" id="submit-game-input-btn">Submit</button>
                    </div>
                    <div class="error" id="game-error"></div>

                    <!-- Optional Battle UI -->
                    <div id="battle-ui" class="hidden"></div>
                </div>

                <!-- Right Column: Player Stats and Inventory -->
                <div class="col-md-4 border border-white rounded scrollable-section">
                    <h3 class="title">Character</h3>
                    <div class="accordion accordion-flush" id="characterAccordion">
                        <!-- Quests Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingQuests">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseQuests" aria-expanded="false"
                                    aria-controls="flush-collapseQuests">
                                    Quests
                                </button>
                            </h2>
                            <div id="flush-collapseQuests" class="accordion-collapse collapse"
                                aria-labelledby="headingQuests">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added quest accordions -->
                                    <div class="accordion accordion-flush" id="questsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Items Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingItems">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseItems" aria-expanded="false"
                                    aria-controls="flush-collapseItems">
                                    Items
                                </button>
                            </h2>
                            <div id="flush-collapseItems" class="accordion-collapse collapse"
                                aria-labelledby="headingItems">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added item accordions -->
                                    <div class="accordion accordion-flush" id="itemsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Skills Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingSkills">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseSkills" aria-expanded="false"
                                    aria-controls="flush-collapseSkills">
                                    Skills
                                </button>
                            </h2>
                            <div id="flush-collapseSkills" class="accordion-collapse collapse"
                                aria-labelledby="headingSkills">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added skill accordions -->
                                    <div class="accordion accordion-flush" id="skillsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Statuses Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingStatuses">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseStatuses" aria-expanded="false"
                                    aria-controls="flush-collapseStatuses">
                                    Statuses
                                </button>
                            </h2>
                            <div id="flush-collapseStatuses" class="accordion-collapse collapse"
                                aria-labelledby="headingStatuses">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added status accordions -->
                                    <div class="accordion accordion-flush" id="statusesAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Relationships Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingRelationships">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseRelationships" aria-expanded="false"
                                    aria-controls="flush-collapseRelationships">
                                    Relationships
                                </button>
                            </h2>
                            <div id="flush-collapseRelationships" class="accordion-collapse collapse"
                                aria-labelledby="headingRelationships">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added relationship accordions -->
                                    <div class="accordion accordion-flush" id="relationshipsAccordion"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Stats Dropdown -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingStats">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#flush-collapseStats" aria-expanded="false"
                                    aria-controls="flush-collapseStats">
                                    Stats
                                </button>
                            </h2>
                            <div id="flush-collapseStats" class="accordion-collapse collapse"
                                aria-labelledby="headingStats">
                                <div class="accordion-body">
                                    <!-- Placeholder for dynamically added stat accordions -->
                                    <div class="accordion accordion-flush" id="statsAccordion"></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div id="options-view">
            <div class="form-group" id="new-game-view">
                <div class="input">
                    <label class="input-label" for="new-game-character-name-input">üë§ Character Name</label>
                    <input type="text" class="form-control" id="new-game-character-name-input"
                        name="new-game-character-name-input" placeholder="Enter your character's name (optional)">
                </div>
                <div class="input">
                    <label class="input-label" for="new-game-character-age-input">üéÇ Age</label>
                    <input type="number" class="form-control" id="new-game-character-age-input"
                        name="new-game-character-age-input" placeholder="Enter age (optional)" min="1" max="999">
                </div>
                <div class="input">
                    <label class="input-label" for="new-game-character-gender-input">‚öß Gender</label>
                    <select class="form-control" id="new-game-character-gender-input"
                        name="new-game-character-gender-input">
                        <option value="">Select gender (optional)</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="input">
                    <label class="input-label" for="new-game-character-class-input">‚öîÔ∏è Class</label>
                    <select class="form-control" id="new-game-character-class-input"
                        name="new-game-character-class-input">
                        <option value="">Select class (optional)</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="input">
                    <label class="input-label" for="new-game-inspiration-input">üí≠ Story Inspiration</label>
                    <textarea class="form-control" id="new-game-inspiration-input" name="new-game-inspiration-input"
                        placeholder="Describe your story inspiration, themes, or setting ideas... (optional)" rows="4"></textarea>
                </div>
                <button type="button" class="submit-button" id="create-seed-btn">üå± Create New Adventure</button>
            </div>

            <div id="load-game-view">

            </div>
            <div id="story-settings-view">

            </div>
            <div id="api-keys-view">
                <div class="input">
                    <label class="input-label" for="openai-api-key-input">ü§ñ OpenAI API Key</label>
                    <input class="form-control" type="password" id="openai-api-key-input"
                        name="openai-api-key-input" placeholder="sk-... (Required for narrative generation)">
                </div>
                <div class="input">
                    <label class="input-label" for="groq-api-key-input">‚ö° Groq API Key</label>
                    <input class="form-control" type="password" id="groq-api-key-input" name="groq-api-key-input"
                        placeholder="gsk_... (Required for fast processing)">
                </div>
                <button type="button" class="other-button" id="save-api-keys-btn">üíæ Save to Local Storage</button>
                <div id="api-keys-note">
                    <strong>üîí Privacy Notice:</strong> This feature is optional and uses your browser's local storage
                    to remember your API keys. We <strong>DO NOT</strong> store or transmit your keys to any server.
                    The keys remain in your browser only. Both API keys are required for the application to function properly.
                </div>
            </div>
        </div>
    </div>

</body>

</html>